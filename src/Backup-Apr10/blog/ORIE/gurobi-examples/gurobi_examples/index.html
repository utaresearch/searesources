<!DOCTYPE html>
<html lang="en" dir="ltr"><head>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.109.0">
<title>Gurobi Basic LP/MIP Examples | Erick C. Jones Jr.</title>








  
    
  
<meta name="description" content="The personal and lab website for Erick C. Jones Jr..">


<meta property="og:site_name" content="Erick C. Jones Jr.">
<meta property="og:title" content="Gurobi Basic LP/MIP Examples | Erick C. Jones Jr.">
<meta property="og:description" content="The personal and lab website for Erick C. Jones Jr.." />
<meta property="og:type" content="page" />
<meta property="og:url" content="/blog/orie/gurobi-examples/gurobi_examples/" />
<meta property="og:locale" content="en">




    
        <meta property="og:image" content="/blog/sidebar-listing.jpg" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="/blog/sidebar-listing.jpg" >
    
    
  <meta itemprop="name" content="Gurobi Basic LP/MIP Examples">
<meta itemprop="description" content="This post explores how to use Gurobi to solve LPs and MIPs. I have written these using Gurobi as a solver and as the mathematical formulation software. This is a reproducible example if you have R Studio just make sure you have installed the correct packages.
library(gurobi) ## Warning: package &#39;slam&#39; was built under R version 4.1.2 library(Matrix) This example formulates and solves the following simple LP model: \(max: x &#43; 2y &#43; 3z\)"><meta itemprop="datePublished" content="2020-01-05T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-01-05T00:00:00+00:00" />
<meta itemprop="wordCount" content="4150">
<meta itemprop="keywords" content="R Markdown,LP,MIP,Gurobi," />
  
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon1.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon1.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.508aa34bb4fa7ebfddd6892a4ec251e1ce46ad0e0c5be6380abc84336f01b14e.css" integrity="sha256-UIqjS7T6fr/d1okqTsJR4c5GrQ4MW&#43;Y4CryEM28BsU4=" media="screen">
  
  
  <script src="/panelset.min.ed1ac24b6e16f4e2481e3d1d098ae66f5bc77438aef619e6e266d8ac5b00dc72.js" type="text/javascript"></script>
  
  
  <script src="/main.min.d6544777aaabf7d9bd89074f1eba9acd9e3aaaf0abdde635292a508d3c533ab9.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="/" title="Home">
      <img src="/img/SApic.jpg" class="dib db-l h2 w-auto" alt="Erick C. Jones Jr.">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="About">About</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/project/" title="Project Portfolio">Projects</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/publication/" title="Publications">Publications</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/team/" title="Teams">TEAM</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/jointeam/" title="Join Team">Join Team</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Posts">Posts</a>
      
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Gurobi Basic LP/MIP Examples</h1>
        
        <p class="f6 measure lh-copy mv1">By Erick Jones in <a href="/categories/orie-basics">ORIE Basics</a> </p>
        <p class="f7 db mv0 ttu">January 5, 2020</p>

      

      </header>
      <section class="post-body pt5 pb4">
        <p>This post explores how to use Gurobi to solve LPs and MIPs.
I have written these using Gurobi as a solver and as the mathematical formulation software.
This is a reproducible example if you have R Studio just  make sure you have installed the correct packages.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">library</span>(gurobi)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: package &#39;slam&#39; was built under R version 4.1.2
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">library</span>(Matrix)
</span></span></code></pre></div><p>This example formulates and solves the following simple LP model:
<code>\(max: x + 2y + 3z\)</code></p>
<p>subject to
<code>\(x +   y  \leq 1\)</code>
<code>\(y +   z \leq 1\)</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A          <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">matrix</span>(<span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>,<span style="color:#099">1</span>,<span style="color:#099">0</span>,<span style="color:#099">0</span>,<span style="color:#099">1</span>,<span style="color:#099">1</span>), nrow<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>, byrow<span style="color:#000;font-weight:bold">=</span><span style="color:#999">T</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj        <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">3</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;max&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs        <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>,<span style="color:#099">1</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;&lt;&#39;</span>, <span style="color:#d14">&#39;&lt;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 2 rows, 3 columns and 4 nonzeros
## Model fingerprint: 0x8d9b7076
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [1e+00, 3e+00]
##   Bounds range     [0e+00, 0e+00]
##   RHS range        [1e+00, 1e+00]
## Presolve removed 2 rows and 3 columns
## Presolve time: 0.00s
## Presolve: All rows and columns removed
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    4.0000000e+00   0.000000e+00   0.000000e+00      0s
## 
## Solved in 0 iterations and 0.00 seconds
## Optimal objective  4.000000000e+00
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>objval)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 4
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>x)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1 0 1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Second option for A - as a sparseMatrix (using the Matrix package)...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(<span style="color:#099">2</span>, <span style="color:#099">3</span>, <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>), <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>), <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>params <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>(Method<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>, TimeLimit<span style="color:#000;font-weight:bold">=</span><span style="color:#099">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, params)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 2 rows, 3 columns and 4 nonzeros
## Model fingerprint: 0x8d9b7076
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [1e+00, 3e+00]
##   Bounds range     [0e+00, 0e+00]
##   RHS range        [1e+00, 1e+00]
## Presolve removed 2 rows and 3 columns
## Presolve time: 0.00s
## Presolve: All rows and columns removed
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    4.0000000e+00   0.000000e+00   0.000000e+00      0s
## 
## Solved in 0 iterations and 0.00 seconds
## Optimal objective  4.000000000e+00
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>objval)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 4
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>x)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1 0 1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Third option for A - as a sparse triplet matrix (using the slam package)...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">simple_triplet_matrix</span>(<span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>), <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>), <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>params <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>(Method<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>, TimeLimit<span style="color:#000;font-weight:bold">=</span><span style="color:#099">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, params)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 2 rows, 3 columns and 4 nonzeros
## Model fingerprint: 0x8d9b7076
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [1e+00, 3e+00]
##   Bounds range     [0e+00, 0e+00]
##   RHS range        [1e+00, 1e+00]
## Presolve removed 2 rows and 3 columns
## Presolve time: 0.00s
## Presolve: All rows and columns removed
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    4.0000000e+00   0.000000e+00   0.000000e+00      0s
## 
## Solved in 0 iterations and 0.00 seconds
## Optimal objective  4.000000000e+00
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>objval)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 4
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>x)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1 0 1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">rm</span>(result, params, model)
</span></span></code></pre></div><p>This example formulates and solves the following simple MIP model:
<code>\(max: x +   y + 2 z\)</code>
subject to
<code>\(x + 2 y + 3 z \leq 4\)</code>
<code>\(x +   y       \geq 1\)</code>
x, y, z binary</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A          <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">matrix</span>(<span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">3</span>,<span style="color:#099">1</span>,<span style="color:#099">1</span>,<span style="color:#099">0</span>), nrow<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>, ncol<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>, byrow<span style="color:#000;font-weight:bold">=</span><span style="color:#999">T</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj        <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>,<span style="color:#099">1</span>,<span style="color:#099">2</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;max&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs        <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">4</span>,<span style="color:#099">1</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;&lt;&#39;</span>, <span style="color:#d14">&#39;&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>vtype      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;B&#39;</span>,<span style="color:#d14">&#39;B&#39;</span>,<span style="color:#d14">&#39;B&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>params <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>(OutputFlag<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, params)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(<span style="color:#d14">&#39;Solution:&#39;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] &#34;Solution:&#34;
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>objval)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 3
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">print</span>(result<span style="color:#000;font-weight:bold">$</span>x)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1 0 1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">rm</span>(model, result, params)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Solve the classic diet model, showing how to add constraints</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># to an existing model.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># define primitive data</span>
</span></span><span style="display:flex;"><span>Categories      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;calories&#39;</span>, <span style="color:#d14">&#39;protein&#39;</span>, <span style="color:#d14">&#39;fat&#39;</span>, <span style="color:#d14">&#39;sodium&#39;</span>)
</span></span><span style="display:flex;"><span>nCategories     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">length</span>(Categories)
</span></span><span style="display:flex;"><span>minNutrition    <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(     <span style="color:#099">1800</span> ,       <span style="color:#099">91</span> ,    <span style="color:#099">0</span> ,       <span style="color:#099">0</span> )
</span></span><span style="display:flex;"><span>maxNutrition    <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(     <span style="color:#099">2200</span> ,      <span style="color:#000;font-weight:bold">Inf</span> ,   <span style="color:#099">65</span> ,    <span style="color:#099">1779</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Foods           <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;hamburger&#39;</span>, <span style="color:#d14">&#39;chicken&#39;</span>, <span style="color:#d14">&#39;hot dog&#39;</span>, <span style="color:#d14">&#39;fries&#39;</span>, <span style="color:#d14">&#39;macaroni&#39;</span>,
</span></span><span style="display:flex;"><span>                     <span style="color:#d14">&#39;pizza&#39;</span>, <span style="color:#d14">&#39;salad&#39;</span>, <span style="color:#d14">&#39;milk&#39;</span>, <span style="color:#d14">&#39;ice cream&#39;</span>)
</span></span><span style="display:flex;"><span>nFoods          <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">length</span>(Foods)
</span></span><span style="display:flex;"><span>cost            <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">2.49</span>, <span style="color:#099">2.89</span>, <span style="color:#099">1.50</span>, <span style="color:#099">1.89</span>, <span style="color:#099">2.09</span>, <span style="color:#099">1.99</span>, <span style="color:#099">2.49</span>, <span style="color:#099">0.89</span>, <span style="color:#099">1.59</span>)
</span></span><span style="display:flex;"><span>nutritionValues <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">410</span>, <span style="color:#099">24</span>, <span style="color:#099">26</span> ,  <span style="color:#099">730</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">420</span>, <span style="color:#099">32</span>, <span style="color:#099">10</span> , <span style="color:#099">1190</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">560</span>, <span style="color:#099">20</span>, <span style="color:#099">32</span> , <span style="color:#099">1800</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">380</span>,  <span style="color:#099">4</span>, <span style="color:#099">19</span> ,  <span style="color:#099">270</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">320</span>, <span style="color:#099">12</span>, <span style="color:#099">10</span> ,  <span style="color:#099">930</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">320</span>, <span style="color:#099">15</span>, <span style="color:#099">12</span> ,  <span style="color:#099">820</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">320</span>, <span style="color:#099">31</span>, <span style="color:#099">12</span> , <span style="color:#099">1230</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">100</span>,  <span style="color:#099">8</span>, <span style="color:#099">2.5</span>,  <span style="color:#099">125</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#099">330</span>,  <span style="color:#099">8</span>, <span style="color:#099">10</span> ,  <span style="color:#099">180</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Each constraint is basically the Nutrion = sum(food*nut/food)</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Could have just made nutrition the RHS, but it works as a bounded variable because you need both upper and lower and it shrinks the amount of equations</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Objective min cost of food</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Build model</span>
</span></span><span style="display:flex;"><span>model     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#spMatrix tells you where to put the non zero values in matrix i,j is the location and x are teh values for each pair</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A   <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nCategories, nCategories <span style="color:#000;font-weight:bold">+</span> nFoods,
</span></span><span style="display:flex;"><span>               i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span><span style="color:#099">4</span>,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">+</span>nFoods)),
</span></span><span style="display:flex;"><span>               j <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span>, (nCategories<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span>(nCategories<span style="color:#000;font-weight:bold">+</span>nFoods),
</span></span><span style="display:flex;"><span>                     <span style="color:#099">2</span>, (nCategories<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span>(nCategories<span style="color:#000;font-weight:bold">+</span>nFoods),
</span></span><span style="display:flex;"><span>                     <span style="color:#099">3</span>, (nCategories<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span>(nCategories<span style="color:#000;font-weight:bold">+</span>nFoods),
</span></span><span style="display:flex;"><span>                     <span style="color:#099">4</span>, (nCategories<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span>(nCategories<span style="color:#000;font-weight:bold">+</span>nFoods) ),
</span></span><span style="display:flex;"><span>               x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">-1.0</span>, nutritionValues[1 <span style="color:#000;font-weight:bold">+</span> nCategories<span style="color:#000;font-weight:bold">*</span>(<span style="color:#099">0</span><span style="color:#000;font-weight:bold">:</span>(nFoods<span style="color:#099">-1</span>))],
</span></span><span style="display:flex;"><span>                     <span style="color:#099">-1.0</span>, nutritionValues[2 <span style="color:#000;font-weight:bold">+</span> nCategories<span style="color:#000;font-weight:bold">*</span>(<span style="color:#099">0</span><span style="color:#000;font-weight:bold">:</span>(nFoods<span style="color:#099">-1</span>))],
</span></span><span style="display:flex;"><span>                     <span style="color:#099">-1.0</span>, nutritionValues[3 <span style="color:#000;font-weight:bold">+</span> nCategories<span style="color:#000;font-weight:bold">*</span>(<span style="color:#099">0</span><span style="color:#000;font-weight:bold">:</span>(nFoods<span style="color:#099">-1</span>))],
</span></span><span style="display:flex;"><span>                     <span style="color:#099">-1.0</span>, nutritionValues[4 <span style="color:#000;font-weight:bold">+</span> nCategories<span style="color:#000;font-weight:bold">*</span>(<span style="color:#099">0</span><span style="color:#000;font-weight:bold">:</span>(nFoods<span style="color:#099">-1</span>))] ))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj         <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>, nCategories), cost)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>lb          <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(minNutrition, <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>, nFoods))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>ub          <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(maxNutrition, <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#000;font-weight:bold">Inf</span>, nFoods))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>varnames    <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(Categories, Foods)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>,nCategories)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;=&#39;</span>,nCategories)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> Categories
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelname   <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;diet&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;min&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># display results</span>
</span></span><span style="display:flex;"><span>printSolution <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(model, res, nCategories, nFoods) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">if </span>(res<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\nCost: &#39;</span>,res<span style="color:#000;font-weight:bold">$</span>objval,<span style="color:#d14">&#39;\nBuy:\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">for </span>(j in nCategories <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nFoods) {
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">if </span>(res<span style="color:#000;font-weight:bold">$</span>x[j] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">1e-4</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#900;font-weight:bold">format</span>(model<span style="color:#000;font-weight:bold">$</span>varnames[j],justify<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;left&#39;</span>,width<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>),<span style="color:#d14">&#39;:&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#900;font-weight:bold">format</span>(res<span style="color:#000;font-weight:bold">$</span>x[j],justify<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;right&#39;</span>,width<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>,nsmall<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>),<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\nNutrition:\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">for </span>(j in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nCategories) {
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#900;font-weight:bold">format</span>(model<span style="color:#000;font-weight:bold">$</span>varnames[j],justify<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;left&#39;</span>,width<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>),<span style="color:#d14">&#39;:&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#900;font-weight:bold">format</span>(res<span style="color:#000;font-weight:bold">$</span>x[j],justify<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;right&#39;</span>,width<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>,nsmall<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>),<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } else {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;No solution\n&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Optimize</span>
</span></span><span style="display:flex;"><span>res <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 4 rows, 13 columns and 40 nonzeros
## Model fingerprint: 0xff20f824
## Coefficient statistics:
##   Matrix range     [1e+00, 2e+03]
##   Objective range  [9e-01, 3e+00]
##   Bounds range     [7e+01, 2e+03]
##   RHS range        [0e+00, 0e+00]
## Presolve removed 0 rows and 3 columns
## Presolve time: 0.00s
## Presolved: 4 rows, 10 columns, 37 nonzeros
## 
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    0.0000000e+00   1.472500e+02   0.000000e+00      0s
##        4    1.1828861e+01   0.000000e+00   0.000000e+00      0s
## 
## Solved in 4 iterations and 0.00 seconds
## Optimal objective  1.182886111e+01
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">printSolution</span>(model, res, nCategories, nFoods)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Cost:  11.82886 
## Buy:
## hamburger  :  0.6045139 
## milk       :   6.970139 
## ice cream  :   2.591319 
## 
## Nutrition:
## calories   :    1800.00 
## protein    :      91.00 
## fat        :    59.0559 
## sodium     :    1779.00
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Adding constraint: at most 6 servings of dairy</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># this is the matrix part of the constraint</span>
</span></span><span style="display:flex;"><span>B <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(<span style="color:#099">1</span>, nCategories <span style="color:#000;font-weight:bold">+</span> nFoods,
</span></span><span style="display:flex;"><span>              i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,<span style="color:#099">2</span>),
</span></span><span style="display:flex;"><span>              j <span style="color:#000;font-weight:bold">=</span> (nCategories<span style="color:#000;font-weight:bold">+</span><span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">8</span>,<span style="color:#099">9</span>)),
</span></span><span style="display:flex;"><span>              x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,<span style="color:#099">2</span>))
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># append B to A</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A           <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rbind</span>(model<span style="color:#000;font-weight:bold">$</span>A,       B)
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># extend row-related vectors</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(model<span style="color:#000;font-weight:bold">$</span>constrnames, <span style="color:#d14">&#39;limit_dairy&#39;</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(model<span style="color:#000;font-weight:bold">$</span>rhs,         <span style="color:#099">10</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(model<span style="color:#000;font-weight:bold">$</span>sense,       <span style="color:#d14">&#39;&lt;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Optimize</span>
</span></span><span style="display:flex;"><span>res <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 5 rows, 13 columns and 42 nonzeros
## Model fingerprint: 0xc012cadd
## Coefficient statistics:
##   Matrix range     [1e+00, 2e+03]
##   Objective range  [9e-01, 3e+00]
##   Bounds range     [7e+01, 2e+03]
##   RHS range        [1e+01, 1e+01]
## Presolve removed 0 rows and 3 columns
## Presolve time: 0.00s
## Presolved: 5 rows, 10 columns, 39 nonzeros
## 
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    0.0000000e+00   1.472500e+02   0.000000e+00      0s
##        4    1.1828861e+01   0.000000e+00   0.000000e+00      0s
## 
## Solved in 4 iterations and 0.00 seconds
## Optimal objective  1.182886111e+01
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#900;font-weight:bold">printSolution</span>(model, res, nCategories, nFoods)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Cost:  11.82886 
## Buy:
## hamburger  :  0.6045139 
## milk       :   6.970139 
## ice cream  :   2.591319 
## 
## Nutrition:
## calories   :    1800.00 
## protein    :      91.00 
## fat        :    59.0559 
## sodium     :    1779.00
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#rm(res, model)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Facility Location Problem (MIP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># define primitive data</span>
</span></span><span style="display:flex;"><span>nPlants     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">5</span>
</span></span><span style="display:flex;"><span>nWarehouses <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">4</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Warehouse demand in thousands of units</span>
</span></span><span style="display:flex;"><span>Demand      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">15</span>, <span style="color:#099">18</span>, <span style="color:#099">14</span>, <span style="color:#099">20</span>)
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Plant capacity in thousands of units </span>
</span></span><span style="display:flex;"><span>Capacity    <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">20</span>, <span style="color:#099">22</span>, <span style="color:#099">17</span>, <span style="color:#099">19</span>, <span style="color:#099">18</span>)
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Fixed costs for each plant </span>
</span></span><span style="display:flex;"><span>FixedCosts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">12000</span>, <span style="color:#099">15000</span>, <span style="color:#099">17000</span>, <span style="color:#099">13000</span>, <span style="color:#099">16000</span>)
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Transportation costs per thousand units </span>
</span></span><span style="display:flex;"><span>TransCosts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">4000</span>, <span style="color:#099">2000</span>, <span style="color:#099">3000</span>, <span style="color:#099">2500</span>, <span style="color:#099">4500</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#099">2500</span>, <span style="color:#099">2600</span>, <span style="color:#099">3400</span>, <span style="color:#099">3000</span>, <span style="color:#099">4000</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#099">1200</span>, <span style="color:#099">1800</span>, <span style="color:#099">2600</span>, <span style="color:#099">4100</span>, <span style="color:#099">3000</span>,
</span></span><span style="display:flex;"><span>                 <span style="color:#099">2200</span>, <span style="color:#099">2600</span>, <span style="color:#099">3100</span>, <span style="color:#099">3700</span>, <span style="color:#099">3200</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flowidx <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(w, p) {nPlants <span style="color:#000;font-weight:bold">*</span> (w<span style="color:#099">-1</span>) <span style="color:#000;font-weight:bold">+</span> p}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Build model</span>
</span></span><span style="display:flex;"><span>model <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelname <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;facility&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;min&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># initialize data for variables</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>lb       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>ub       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>, nPlants),   <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#000;font-weight:bold">Inf</span>, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>vtype    <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;B&#39;</span>, nPlants), <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;C&#39;</span>, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(FixedCosts, TransCosts)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>varnames <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">paste0</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;Open&#39;</span>,nPlants),<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants),
</span></span><span style="display:flex;"><span>                    <span style="color:#900;font-weight:bold">sprintf</span>(<span style="color:#d14">&#39;Trans%d,%d&#39;</span>,
</span></span><span style="display:flex;"><span>                            <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWarehouses,nPlants)),
</span></span><span style="display:flex;"><span>                            <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># build production constraint matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#uses custom functions to fill out matrix, a bit out my wheelhouse</span>
</span></span><span style="display:flex;"><span>A1 <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nPlants, nPlants, i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants), j <span style="color:#000;font-weight:bold">=</span> (<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants), x <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span>Capacity)
</span></span><span style="display:flex;"><span>A2 <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nPlants, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses,
</span></span><span style="display:flex;"><span>               i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep, <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants, nWarehouses)),
</span></span><span style="display:flex;"><span>               j <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">mapply</span>(flowidx,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWarehouses,<span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants,nWarehouses))),
</span></span><span style="display:flex;"><span>               x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>, nWarehouses <span style="color:#000;font-weight:bold">*</span> nPlants))
</span></span><span style="display:flex;"><span>A3 <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nWarehouses, nPlants)
</span></span><span style="display:flex;"><span>A4 <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nWarehouses, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses,
</span></span><span style="display:flex;"><span>               i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep, <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWarehouses, nPlants)),
</span></span><span style="display:flex;"><span>               j <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">mapply</span>(flowidx,<span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWarehouses,nPlants)),<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants),
</span></span><span style="display:flex;"><span>               x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A           <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rbind</span>(<span style="color:#900;font-weight:bold">cbind</span>(A1, A2), <span style="color:#900;font-weight:bold">cbind</span>(A3, A4))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>, nPlants),   Demand)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;&lt;&#39;</span>, nPlants), <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;=&#39;</span>, nWarehouses))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">sprintf</span>(<span style="color:#d14">&#39;Capacity%d&#39;</span>,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nPlants),
</span></span><span style="display:flex;"><span>                       <span style="color:#900;font-weight:bold">sprintf</span>(<span style="color:#d14">&#39;Demand%d&#39;</span>,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWarehouses))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Save model</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">gurobi_write</span>(model,<span style="color:#d14">&#39;facilityR.lp&#39;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## NULL
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Guess at the starting point: close the plant with the highest fixed</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># costs; open all others first open all plants</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>start <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,nPlants),<span style="color:#900;font-weight:bold">rep</span>(<span style="color:#000;font-weight:bold">NA</span>, nPlants <span style="color:#000;font-weight:bold">*</span> nWarehouses))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># find most expensive plant, and close it in mipstart</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Initial guess:\n&#39;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Initial guess:
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>worstidx <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">which.max</span>(FixedCosts)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>start[worstidx] <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Closing plant&#39;</span>,worstidx,<span style="color:#d14">&#39;\n&#39;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Closing plant 3
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># set parameters</span>
</span></span><span style="display:flex;"><span>params <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>params<span style="color:#000;font-weight:bold">$</span>method <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Optimize</span>
</span></span><span style="display:flex;"><span>res <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, params)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 9 rows, 25 columns and 45 nonzeros
## Model fingerprint: 0x36b45dc0
## Variable types: 20 continuous, 5 integer (5 binary)
## Coefficient statistics:
##   Matrix range     [1e+00, 2e+01]
##   Objective range  [1e+03, 2e+04]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+01, 2e+01]
## 
## User MIP start produced solution with objective 210500 (0.00s)
## Loaded user MIP start with objective 210500
## 
## Presolve time: 0.00s
## Presolved: 9 rows, 25 columns, 45 nonzeros
## Variable types: 20 continuous, 5 integer (5 binary)
## Root barrier log...
## 
## Ordering time: 0.00s
## 
## Barrier statistics:
##  AA&#39; NZ     : 2.000e+01
##  Factor NZ  : 4.500e+01
##  Factor Ops : 2.850e+02 (less than 1 second per iteration)
##  Threads    : 1
## 
##                   Objective                Residual
## Iter       Primal          Dual         Primal    Dual     Compl     Time
##    0   7.94290841e+05 -2.24842916e+05  7.25e+00 3.75e+03  2.69e+04     0s
##    1   2.34432856e+05  7.59319096e+04  1.78e-15 3.64e-12  3.17e+03     0s
##    2   2.10232015e+05  1.89880475e+05  8.88e-16 4.01e-12  4.07e+02     0s
##    3   2.00964341e+05  1.98582137e+05  9.77e-15 2.79e-12  4.76e+01     0s
##    4   1.99878036e+05  1.99804970e+05  2.46e-13 3.19e-12  1.46e+00     0s
##    5   1.99833638e+05  1.99832960e+05  3.14e-13 1.82e-12  1.36e-02     0s
##    6   1.99833333e+05  1.99833333e+05  1.47e-14 2.86e-12  1.39e-08     0s
##    7   1.99833333e+05  1.99833333e+05  7.10e-15 2.73e-12  1.39e-14     0s
## 
## Barrier solved model in 7 iterations and 0.01 seconds
## Optimal objective 1.99833333e+05
## 
## 
## Root relaxation: objective 1.998333e+05, 6 iterations, 0.01 seconds
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 199833.333    0    1 210500.000 199833.333  5.07%     -    0s
##      0     0 200252.941    0    1 210500.000 200252.941  4.87%     -    0s
##      0     0 208000.000    0    1 210500.000 208000.000  1.19%     -    0s
## 
## Cutting planes:
##   MIR: 1
##   Flow cover: 3
## 
## Explored 1 nodes (11 simplex iterations) in 0.02 seconds
## Thread count was 20 (of 20 available processors)
## 
## Solution count 1: 210500 
## 
## Optimal solution found (tolerance 1.00e-04)
## Best objective 2.105000000000e+05, best bound 2.105000000000e+05, gap 0.0000%
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Print solution</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">if </span>(res<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\nTotal Costs:&#39;</span>,res<span style="color:#000;font-weight:bold">$</span>objval,<span style="color:#d14">&#39;\nsolution:\n&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Facilities:&#39;</span>, model<span style="color:#000;font-weight:bold">$</span>varnames<span style="color:#900;font-weight:bold">[which</span>(res<span style="color:#000;font-weight:bold">$</span>x[1<span style="color:#000;font-weight:bold">:</span>nPlants]<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#099">1e-5</span>)], <span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>  active <span style="color:#000;font-weight:bold">&lt;-</span> nPlants <span style="color:#000;font-weight:bold">+</span> <span style="color:#900;font-weight:bold">which</span>(res<span style="color:#000;font-weight:bold">$</span>x<span style="color:#900;font-weight:bold">[</span>(nPlants<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span>(nPlants<span style="color:#000;font-weight:bold">*</span>(nWarehouses<span style="color:#099">+1</span>))] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">1e-5</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Flows: &#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#900;font-weight:bold">sprintf</span>(<span style="color:#d14">&#39;%s=%g &#39;</span>,model<span style="color:#000;font-weight:bold">$</span>varnames[active], res<span style="color:#000;font-weight:bold">$</span>x[active]), <span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">rm</span>(active)
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;No solution\n&#39;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Total Costs: 210500 
## solution:
## Facilities: Open1 Open2 Open4 Open5 
## Flows: Trans1,2=14  Trans1,4=1  Trans2,4=18  Trans3,1=14  Trans4,1=6  Trans4,2=8  Trans4,5=6
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">rm</span>(res, model, params, A1, A2, A3, A4)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Assign workers to shifts; each worker may or may not be available on a</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># particular day. If the problem cannot be solved, use IIS iteratively to</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># find all conflicting constraints.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Function to display results</span>
</span></span><span style="display:flex;"><span>printsolution <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(result) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">if</span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;The optimal objective is&#39;</span>,result<span style="color:#000;font-weight:bold">$</span>objval,<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Schedule:\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">for </span>(s in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts) {
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\t&#39;</span>,Shifts[s],<span style="color:#d14">&#39;:&#39;</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">for </span>(w in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>x<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0.9</span>) <span style="color:#900;font-weight:bold">cat</span>(Workers[w],<span style="color:#d14">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># define data</span>
</span></span><span style="display:flex;"><span>nShifts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">14</span>
</span></span><span style="display:flex;"><span>nWorkers <span style="color:#000;font-weight:bold">&lt;-</span>  <span style="color:#099">7</span>
</span></span><span style="display:flex;"><span>nVars    <span style="color:#000;font-weight:bold">&lt;-</span> nShifts <span style="color:#000;font-weight:bold">*</span> nWorkers
</span></span><span style="display:flex;"><span>varIdx   <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(w,s) {s<span style="color:#000;font-weight:bold">+</span>(w<span style="color:#099">-1</span>)<span style="color:#000;font-weight:bold">*</span>nShifts}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Shifts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;Mon1&#39;</span>, <span style="color:#d14">&#39;Tue2&#39;</span>, <span style="color:#d14">&#39;Wed3&#39;</span>, <span style="color:#d14">&#39;Thu4&#39;</span>, <span style="color:#d14">&#39;Fri5&#39;</span>, <span style="color:#d14">&#39;Sat6&#39;</span>, <span style="color:#d14">&#39;Sun7&#39;</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#d14">&#39;Mon8&#39;</span>, <span style="color:#d14">&#39;Tue9&#39;</span>, <span style="color:#d14">&#39;Wed10&#39;</span>, <span style="color:#d14">&#39;Thu11&#39;</span>, <span style="color:#d14">&#39;Fri12&#39;</span>, <span style="color:#d14">&#39;Sat13&#39;</span>, <span style="color:#d14">&#39;Sun14&#39;</span>)
</span></span><span style="display:flex;"><span>Workers <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>( <span style="color:#d14">&#39;Amy&#39;</span>, <span style="color:#d14">&#39;Bob&#39;</span>, <span style="color:#d14">&#39;Cathy&#39;</span>, <span style="color:#d14">&#39;Dan&#39;</span>, <span style="color:#d14">&#39;Ed&#39;</span>, <span style="color:#d14">&#39;Fred&#39;</span>, <span style="color:#d14">&#39;Gu&#39;</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pay     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">10</span>, <span style="color:#099">12</span>, <span style="color:#099">10</span>, <span style="color:#099">8</span>, <span style="color:#099">8</span>, <span style="color:#099">9</span>, <span style="color:#099">11</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>shiftRequirements <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">3</span>, <span style="color:#099">2</span>, <span style="color:#099">4</span>, <span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">5</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>, <span style="color:#099">4</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>, <span style="color:#099">5</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>availability <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>( <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ) )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Set-up environment</span>
</span></span><span style="display:flex;"><span>env <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>env<span style="color:#000;font-weight:bold">$</span>logfile <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;workforce2.log&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Build model</span>
</span></span><span style="display:flex;"><span>model            <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelname  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;workforce2&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;min&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Initialize assignment decision variables:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    x[w][s] == 1 if worker w is assigned</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    to shift s. Since an assignment model always produces integer</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    solutions, we use continuous variables and solve as an LP.</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>lb       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>ub       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>, nVars)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>, nVars)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>varnames <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;&#39;</span>,nVars)
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">for </span>(w in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">for </span>(s in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts) {
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>varnames<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">paste0</span>(Workers[w],<span style="color:#d14">&#39;.&#39;</span>,Shifts[s])
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>obj<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)]      <span style="color:#000;font-weight:bold">=</span> pay[w]
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">if </span>(availability[[w]][s] <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) model<span style="color:#000;font-weight:bold">$</span>ub<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Set-up shift-requirements constraints</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A           <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nShifts,nVars,
</span></span><span style="display:flex;"><span>                      i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts,nWorkers)),
</span></span><span style="display:flex;"><span>                      j <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">mapply</span>(varIdx,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers,
</span></span><span style="display:flex;"><span>                                 <span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts,nWorkers)),
</span></span><span style="display:flex;"><span>                      x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,nShifts <span style="color:#000;font-weight:bold">*</span> nWorkers))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;=&#39;</span>,nShifts)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> shiftRequirements
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> Shifts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Save model</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">gurobi_write</span>(model,<span style="color:#d14">&#39;workforce2.lp&#39;</span>, env)
</span></span></code></pre></div><pre tabindex="0"><code>## NULL
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Optimize</span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 14 rows, 98 columns and 98 nonzeros
## Model fingerprint: 0xbddc1063
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 1 rows and 33 columns
## Presolve time: 0.00s
## 
## Solved in 0 iterations and 0.00 seconds
## Infeasible model
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Display results</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># The code may enter here if you change some of the data... otherwise</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># this will never be executed.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">printsolution</span>(result);
</span></span><span style="display:flex;"><span>} else <span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;INFEASIBLE&#39;</span>) {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># We will loop until we reduce a model that can be solved</span>
</span></span><span style="display:flex;"><span>  numremoved <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">0</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">while</span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;INFEASIBLE&#39;</span>) {
</span></span><span style="display:flex;"><span>    iis               <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi_iis</span>(model, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span><span style="display:flex;"><span>    keep              <span style="color:#000;font-weight:bold">&lt;-</span> (<span style="color:#000;font-weight:bold">!</span>iis<span style="color:#000;font-weight:bold">$</span>Arows)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Removing rows&#39;</span>,model<span style="color:#000;font-weight:bold">$</span>constrnames[iis<span style="color:#000;font-weight:bold">$</span>Arows],<span style="color:#d14">&#39;...\n&#39;</span>)
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>A           <span style="color:#000;font-weight:bold">&lt;-</span> model<span style="color:#000;font-weight:bold">$</span>A[keep,,drop <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">FALSE</span>]
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> model<span style="color:#000;font-weight:bold">$</span>sense[keep]
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> model<span style="color:#000;font-weight:bold">$</span>rhs[keep]
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> model<span style="color:#000;font-weight:bold">$</span>constrnames[keep]
</span></span><span style="display:flex;"><span>    numremoved        <span style="color:#000;font-weight:bold">&lt;-</span> numremoved <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">gurobi_write</span>(model, <span style="color:#900;font-weight:bold">paste0</span>(<span style="color:#d14">&#39;workforce2-&#39;</span>,numremoved,<span style="color:#d14">&#39;.lp&#39;</span>), env)
</span></span><span style="display:flex;"><span>    result            <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">printsolution</span>(result)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">rm</span>(iis)
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Just to handle user interruptions or other problems</span>
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Unexpected status&#39;</span>,result<span style="color:#000;font-weight:bold">$</span>status,<span style="color:#d14">&#39;\nEnding now\n&#39;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>## 
## IIS computed: 1 constraints and 7 bounds
## IIS runtime: 0.00 seconds
## Removing rows Thu4 ...
## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 13 rows, 98 columns and 91 nonzeros
## Model fingerprint: 0xd0134630
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 1 rows and 35 columns
## Presolve time: 0.00s
## 
## Solved in 0 iterations and 0.00 seconds
## Infeasible model
## 
## IIS computed: 1 constraints and 7 bounds
## IIS runtime: 0.00 seconds
## Removing rows Sat6 ...
## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 12 rows, 98 columns and 84 nonzeros
## Model fingerprint: 0x50426357
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 1 rows and 39 columns
## Presolve time: 0.00s
## 
## Solved in 0 iterations and 0.00 seconds
## Infeasible model
## 
## IIS computed: 1 constraints and 7 bounds
## IIS runtime: 0.00 seconds
## Removing rows Sun7 ...
## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 11 rows, 98 columns and 77 nonzeros
## Model fingerprint: 0x23a14e24
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 1 rows and 43 columns
## Presolve time: 0.00s
## 
## Solved in 0 iterations and 0.00 seconds
## Infeasible model
## 
## IIS computed: 1 constraints and 7 bounds
## IIS runtime: 0.00 seconds
## Removing rows Fri12 ...
## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 10 rows, 98 columns and 70 nonzeros
## Model fingerprint: 0xa8fcf019
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 10 rows and 98 columns
## Presolve time: 0.00s
## Presolve: All rows and columns removed
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    3.3500000e+02   0.000000e+00   1.480000e+02      0s
## Extra simplex iterations after uncrush: 5
##        5    3.3500000e+02   0.000000e+00   0.000000e+00      0s
## 
## Solved in 5 iterations and 0.00 seconds
## Optimal objective  3.350000000e+02
## The optimal objective is 335 
## Schedule:
## 	 Mon1 :Ed  Fred  Gu  
## 	 Tue2 :Dan  Ed  
## 	 Wed3 :Amy  Dan  Ed  Fred  
## 	 Thu4 :
## 	 Fri5 :Amy  Cathy  Dan  Ed  Gu  
## 	 Sat6 :
## 	 Sun7 :
## 	 Mon8 :Dan  Ed  
## 	 Tue9 :Dan  Ed  
## 	 Wed10 :Amy  Cathy  Dan  
## 	 Thu11 :Amy  Cathy  Dan  Ed  
## 	 Fri12 :
## 	 Sat13 :Amy  Bob  Cathy  Dan  Ed  Fred  Gu  
## 	 Sun14 :Amy  Cathy  Dan  Ed  Fred
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">rm</span>(model, env, availability, Shifts, Workers, pay, shiftRequirements, result)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Assign workers to shifts; each worker may or may not be available on a</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># particular day. If the problem cannot be solved, relax the model</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># to determine which constraints cannot be satisfied, and how much</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># they need to be relaxed.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Function to display results</span>
</span></span><span style="display:flex;"><span>printsolution <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(result) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">if</span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;The optimal objective is&#39;</span>,result<span style="color:#000;font-weight:bold">$</span>objval,<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Schedule:\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">for </span>(s in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts) {
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\t&#39;</span>,Shifts[s],<span style="color:#d14">&#39;:&#39;</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">for </span>(w in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers) {
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>x<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0.9</span>) <span style="color:#900;font-weight:bold">cat</span>(Workers[w],<span style="color:#d14">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># define data</span>
</span></span><span style="display:flex;"><span>nShifts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">14</span>
</span></span><span style="display:flex;"><span>nWorkers <span style="color:#000;font-weight:bold">&lt;-</span>  <span style="color:#099">7</span>
</span></span><span style="display:flex;"><span>nVars    <span style="color:#000;font-weight:bold">&lt;-</span> nShifts <span style="color:#000;font-weight:bold">*</span> nWorkers
</span></span><span style="display:flex;"><span>varIdx   <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">function</span>(w,s) {s<span style="color:#000;font-weight:bold">+</span>(w<span style="color:#099">-1</span>)<span style="color:#000;font-weight:bold">*</span>nShifts}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Shifts  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#d14">&#39;Mon1&#39;</span>, <span style="color:#d14">&#39;Tue2&#39;</span>, <span style="color:#d14">&#39;Wed3&#39;</span>, <span style="color:#d14">&#39;Thu4&#39;</span>, <span style="color:#d14">&#39;Fri5&#39;</span>, <span style="color:#d14">&#39;Sat6&#39;</span>, <span style="color:#d14">&#39;Sun7&#39;</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#d14">&#39;Mon8&#39;</span>, <span style="color:#d14">&#39;Tue9&#39;</span>, <span style="color:#d14">&#39;Wed10&#39;</span>, <span style="color:#d14">&#39;Thu11&#39;</span>, <span style="color:#d14">&#39;Fri12&#39;</span>, <span style="color:#d14">&#39;Sat13&#39;</span>, <span style="color:#d14">&#39;Sun14&#39;</span>)
</span></span><span style="display:flex;"><span>Workers <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>( <span style="color:#d14">&#39;Amy&#39;</span>, <span style="color:#d14">&#39;Bob&#39;</span>, <span style="color:#d14">&#39;Cathy&#39;</span>, <span style="color:#d14">&#39;Dan&#39;</span>, <span style="color:#d14">&#39;Ed&#39;</span>, <span style="color:#d14">&#39;Fred&#39;</span>, <span style="color:#d14">&#39;Gu&#39;</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pay     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">10</span>, <span style="color:#099">12</span>, <span style="color:#099">10</span>, <span style="color:#099">8</span>, <span style="color:#099">8</span>, <span style="color:#099">9</span>, <span style="color:#099">11</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>shiftRequirements <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#099">3</span>, <span style="color:#099">2</span>, <span style="color:#099">4</span>, <span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">5</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>, <span style="color:#099">4</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>, <span style="color:#099">5</span> )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>availability <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>( <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ),
</span></span><span style="display:flex;"><span>                      <span style="color:#900;font-weight:bold">c</span>( <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span> ) )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Set-up environment</span>
</span></span><span style="display:flex;"><span>env <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>env<span style="color:#000;font-weight:bold">$</span>logfile <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;workforce3.log&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Build model</span>
</span></span><span style="display:flex;"><span>model            <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelname  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;workforce3&#39;</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>modelsense <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#d14">&#39;min&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Initialize assignment decision variables:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    x[w][s] == 1 if worker w is assigned</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    to shift s. Since an assignment model always produces integer</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    solutions, we use continuous variables and solve as an LP.</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>lb       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>ub       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>, nVars)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>obj      <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">0</span>, nVars)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>varnames <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;&#39;</span>,nVars)
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">for </span>(w in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers) {
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">for </span>(s in <span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts) {
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>varnames<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">paste0</span>(Workers[w],<span style="color:#d14">&#39;.&#39;</span>,Shifts[s])
</span></span><span style="display:flex;"><span>    model<span style="color:#000;font-weight:bold">$</span>obj<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)]      <span style="color:#000;font-weight:bold">=</span> pay[w]
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">if </span>(availability[[w]][s] <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0</span>) model<span style="color:#000;font-weight:bold">$</span>ub<span style="color:#900;font-weight:bold">[varIdx</span>(w,s)] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Set-up shift-requirements constraints</span>
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>A           <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">spMatrix</span>(nShifts,nVars,
</span></span><span style="display:flex;"><span>                      i <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">c</span>(<span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts,nWorkers)),
</span></span><span style="display:flex;"><span>                      j <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">mapply</span>(varIdx,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nWorkers,
</span></span><span style="display:flex;"><span>                                 <span style="color:#900;font-weight:bold">mapply</span>(rep,<span style="color:#099">1</span><span style="color:#000;font-weight:bold">:</span>nShifts,nWorkers)),
</span></span><span style="display:flex;"><span>                      x <span style="color:#000;font-weight:bold">=</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,nShifts <span style="color:#000;font-weight:bold">*</span> nWorkers))
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>sense       <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#d14">&#39;=&#39;</span>,nShifts)
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>rhs         <span style="color:#000;font-weight:bold">&lt;-</span> shiftRequirements
</span></span><span style="display:flex;"><span>model<span style="color:#000;font-weight:bold">$</span>constrnames <span style="color:#000;font-weight:bold">&lt;-</span> Shifts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Save model</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">gurobi_write</span>(model,<span style="color:#d14">&#39;workforce3.lp&#39;</span>, env)
</span></span></code></pre></div><pre tabindex="0"><code>## NULL
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Optimize</span>
</span></span><span style="display:flex;"><span>result <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(model, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 14 rows, 98 columns and 98 nonzeros
## Model fingerprint: 0xbddc1063
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [8e+00, 1e+01]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 1 rows and 33 columns
## Presolve time: 0.00s
## 
## Solved in 0 iterations and 0.00 seconds
## Infeasible model
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Display results</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># The code may enter here if you change some of the data... otherwise</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># this will never be executed.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">printsolution</span>(result);
</span></span><span style="display:flex;"><span>} else <span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;INFEASIBLE&#39;</span>) {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Use gurobi_feasrelax to find out which copnstraints should be relaxed</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># and by how much to make the problem feasible.</span>
</span></span><span style="display:flex;"><span>  penalties     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">list</span>()
</span></span><span style="display:flex;"><span>  penalties<span style="color:#000;font-weight:bold">$</span>lb  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#000;font-weight:bold">Inf</span>
</span></span><span style="display:flex;"><span>  penalties<span style="color:#000;font-weight:bold">$</span>ub  <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#000;font-weight:bold">Inf</span>
</span></span><span style="display:flex;"><span>  penalties<span style="color:#000;font-weight:bold">$</span>rhs <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">rep</span>(<span style="color:#099">1</span>,<span style="color:#900;font-weight:bold">length</span>(model<span style="color:#000;font-weight:bold">$</span>rhs))
</span></span><span style="display:flex;"><span>  feasrelax     <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi_feasrelax</span>(model, <span style="color:#099">0</span>, <span style="color:#000;font-weight:bold">FALSE</span>, penalties, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span><span style="display:flex;"><span>  result        <span style="color:#000;font-weight:bold">&lt;-</span> <span style="color:#900;font-weight:bold">gurobi</span>(feasrelax<span style="color:#000;font-weight:bold">$</span>model, env <span style="color:#000;font-weight:bold">=</span> env)
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">if </span>(result<span style="color:#000;font-weight:bold">$</span>status <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;OPTIMAL&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">printsolution</span>(result)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Slack values:\n&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">for </span>(j <span style="color:#900;font-weight:bold">in </span>(nVars<span style="color:#099">+1</span>)<span style="color:#000;font-weight:bold">:</span><span style="color:#900;font-weight:bold">length</span>(result<span style="color:#000;font-weight:bold">$</span>x)) {
</span></span><span style="display:flex;"><span>      <span style="color:#900;font-weight:bold">if</span>(result<span style="color:#000;font-weight:bold">$</span>x[j] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">0.1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;\t&#39;</span>,feasrelax<span style="color:#000;font-weight:bold">$</span>model<span style="color:#000;font-weight:bold">$</span>varnames[j],result<span style="color:#000;font-weight:bold">$</span>x[j],<span style="color:#d14">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } else {
</span></span><span style="display:flex;"><span>    <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Unexpected status&#39;</span>,result<span style="color:#000;font-weight:bold">$</span>status,<span style="color:#d14">&#39;\nEnding now\n&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">rm</span>(penalties, feasrelax)
</span></span><span style="display:flex;"><span>} else {
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Just to handle user interruptions or other problems</span>
</span></span><span style="display:flex;"><span>  <span style="color:#900;font-weight:bold">cat</span>(<span style="color:#d14">&#39;Unexpected status&#39;</span>,result<span style="color:#000;font-weight:bold">$</span>status,<span style="color:#d14">&#39;\nEnding now\n&#39;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><pre tabindex="0"><code>## Gurobi Optimizer version 9.1.2 build v9.1.2rc0 (win64)
## Thread count: 10 physical cores, 20 logical processors, using up to 20 threads
## Optimize a model with 14 rows, 126 columns and 126 nonzeros
## Model fingerprint: 0xa5484b98
## Coefficient statistics:
##   Matrix range     [1e+00, 1e+00]
##   Objective range  [1e+00, 1e+00]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [2e+00, 7e+00]
## Presolve removed 5 rows and 99 columns
## Presolve time: 0.00s
## Presolved: 9 rows, 27 columns, 27 nonzeros
## 
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    6.0000000e+00   0.000000e+00   0.000000e+00      0s
##        0    6.0000000e+00   0.000000e+00   0.000000e+00      0s
## 
## Solved in 0 iterations and 0.00 seconds
## Optimal objective  6.000000000e+00
## The optimal objective is 6 
## Schedule:
## 	 Mon1 :Ed  Fred  Gu  
## 	 Tue2 :Bob  Ed  
## 	 Wed3 :Amy  Cathy  Fred  Gu  
## 	 Thu4 :Cathy  Ed  
## 	 Fri5 :Amy  Cathy  Dan  Ed  Gu  
## 	 Sat6 :Bob  Dan  Fred  Gu  
## 	 Sun7 :Amy  Cathy  Ed  Gu  
## 	 Mon8 :Dan  Ed  
## 	 Tue9 :Dan  Gu  
## 	 Wed10 :Amy  Dan  Gu  
## 	 Thu11 :Amy  Bob  Ed  Gu  
## 	 Fri12 :Amy  Cathy  Dan  Fred  Gu  
## 	 Sat13 :Amy  Bob  Cathy  Dan  Ed  Fred  Gu  
## 	 Sun14 :Amy  Cathy  Ed  Fred  Gu  
## Slack values:
## 	 ArtP_Thu4 2 
## 	 ArtP_Sat6 2 
## 	 ArtP_Sun7 1 
## 	 ArtP_Fri12 1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Clear space</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">rm</span>(model, env, availability, Shifts, Workers, pay, shiftRequirements, result)
</span></span></code></pre></div><p>Add a new chunk by clicking the <em>Insert Chunk</em> button on the toolbar or by pressing <em>Ctrl+Alt+I</em>.</p>
<p>When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the <em>Preview</em> button or press <em>Ctrl+Shift+K</em> to preview the HTML file).</p>
<p>The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike <em>Knit</em>, <em>Preview</em> does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.</p>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Posted on:</dt>
    <dd class="fw5 ml0">January 5, 2020</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Length:</dt>
    <dd class="fw5 ml0">20 minute read, 4150 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categories:</dt>
    <dd class="fw5 ml0"> <a href="/categories/orie-basics">ORIE Basics</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="/tags/r-markdown">R Markdown</a>  <a href="/tags/lp">LP</a>  <a href="/tags/mip">MIP</a>  <a href="/tags/gurobi">Gurobi</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">See Also:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/orie/decomp-algorithms/decompo_algs/">Decompositions Algorithms Broken Down and Explained</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/orie/bender-decomp/benders/">Benders Decomposition Algorithm Explained</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/orie/qp-modeling/qp_algorithms/">Quadratic Programming Examples and Algorithms</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="/blog/orie/gurobi-examples-2/gurobi_examples2/">&larr; Gurboi&#39;s R Examples 2</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="/blog/orie/markov-chains/markovchains/">Basics of Markov Chains &rarr;</a>
  
</div>

      </footer>
    </article>
    
      
<div class="post-comments pa0 pa4-l mt4">
  
  <script src="https://utteranc.es/client.js"
          repo="apreshill/apero"
          issue-term="pathname"
          theme="boxy-light"
          label="comments :crystal_ball:"
          crossorigin="anonymous"
          async
          type="text/javascript">
  </script>
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2023 Erick Jones, Texas
      <span class="middot-divider"></span>
      Made with <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apro</a></span>.
      <br />
      
Based on <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
